<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.board.mapper.shopMapper">
	<!-- 카테고리별 상품 리스트: 1차분류 -->
	<select id="list1" resultType="com.board.domain.GoodsViewVO">
		select
		g.gdsNum, g.gdsName, g.cateCode, c.cateCodeRef, c.cateName, gdsPrice, gdsStock,
		gdsDes, gdsImg, gdsDate, g.gdsImg, g.gdsThumbImg
		from tbl_goods g
		inner join goods_category c
		on g.cateCode = c.cateCode
		where g.cateCode = #{cateCode}
		or c.cateCodeRef =#{cateCodeRef}
	</select>

	<!--상품 소감 작성 -->
	<insert id="registerReply">
		insert into tbl_reply(gdsNum, userId, rNum, rContent )
		values (#{gdsNum}, #{userId}, tbl_reply_seq.nextval, #{rContent})
	</insert>

	<!-- 상품 소감 리스트 -->
	<select id="replylist" resultType="com.board.domain.ReplyListVO">
		select
		r.gdsNum as gdsNum, r.rNum as rNum, r.rContent as rContent,
		r.userId as userId, r.rDate as rDate, m.userName as userName
		from tbl_reply r
		inner join tbl_member m
		on r.userId = m.userId
		where gdsNum = #{gdsNum}


	</select>
	<!-- 카트 담기 -->
<insert id="addCart">
 insert into tbl_cart (cartNum, userId, gdsNum, cartStock)
     values (tbl_cart_seq.nextval, #{userId}, #{gdsNum}, #{cartStock})
</insert>
	
	<!-- 카트 리스트 -->
<select id="cartList" resultType="com.board.domain.CartListVO">
 select
     row_number() over(order by c.cartNum desc) as num, <!--출력된 결과에 순서표시 -->
     c.cartNum, c.userId, c.gdsNum, c.cartStock, c.addDate,
     g.gdsName, g.gdsPrice, g.gdsThumbImg
 from tbl_cart c
     inner join tbl_goods g
         on c.gdsNum = g.gdsNum   
     where c.userId = #{userId}
</select>
	
	

</mapper>